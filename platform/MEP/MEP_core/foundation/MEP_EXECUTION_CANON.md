# MEP_EXECUTION_CANON
（B A X T C D N R F Z S 実行定義）

本書は、MEP における実行骨格
B A X T C D N R F Z S
の役割・禁止・遷移を固定定義する Canon である。

本書は再設計文書ではない。
意味解釈・一般化・補足説明を行わない。

---

## 0. 正の所在

- 最新確定仕様の唯一の正：X
- 最新確定成果物の唯一の正：S

X と S に存在しないものは、正として扱わない。

N は、R 監査用の旧コード退避領域であり、
正の所在ではない。

N は S に全移行されるまでの間、
一時的に最新退避場所として機能してよい。

S への保存が完了した時点で、
N が空であることを許容する。

---

## 1. 共通定義（全パート共通）

本節は M / E / P に共通する。
パート差分は「遷移先」のみを変更できる。

---

### B（Build）

- 役割：人間による編集・判断の起点
- 入力：人間操作
- 出力：編集結果
- 禁止：
  - 自動処理
- 遷移：
  - 完了 → A

---

### A（Assemble）

- 役割：B の編集結果を統合する
- 入力：B 出力
- 出力：統合結果
- 禁止：
  - 判断
- 遷移：
  - 統合完了 → T
  - ※ 初回かつ X が空の場合、統合結果を X に暫定保存する

---

### X（eXisting）

- 役割：最新確定仕様の保存（履歴保持可）
- 入力：Z OK の仕様
- 出力：参照用最新仕様
- 禁止：
  - 自動書換え
- 遷移：
  - 参照 → T / Z

補足：
- X は履歴を保持してよい
- 常に「最新」を参照対象とする

---

### T（Test）

- 役割：X を参照した仕様監査
- 入力：A 出力 + X（存在する場合）
- 出力：OK / NG
- 禁止：
  - 確定
- 遷移：
  - OK → Z
  - NG → B

---

### Z（Final Guard）

- 役割：最終結論判定
- 入力：T / R OK 後の候補
- 出力：OK / NG
- 禁止：
  - 裁量
  - 解釈
- 遷移：
  - OK → パート差分に従う
  - NG → パート差分に従う

---

### C（Create）

- 役割：仕様に基づく生成
- 入力：X（最新確定仕様）
- 出力：生成物
- 禁止：
  - 仕様変更
- 遷移：
  - 完了 → D

---

### D（Diff）

- 役割：生成物の差分算出
- 入力：生成物
- 出力：差分
- 禁止：
  - 判断
- 遷移：
  - 差分生成 → N

補足：
- 初回生成時、差分が存在しない場合は何も行わない

---

### N（Node）

- 役割：R 監査用の旧コード仮保存
- 入力：差分・生成物
- 出力：比較対象
- 禁止：
  - 正として扱うこと
- 遷移：
  - 監査要求 → R

補足：
- S に全移行後、N は空でよい

---

### R（Rollback）

- 役割：N を参照したコード監査・統合
- 入力：N
- 出力：OK / NG
- 禁止：
  - 確定
- 遷移：
  - OK → Z
  - NG → C

---

### F（Fallback）

- 役割：Z NG 時の全文・人間介入モード
- 入力：Z NG
- 出力：人間判断
- 禁止：
  - 自動処理
- 遷移：
  - 人間確定 → C

---

### S（Store）

- 役割：最終確定成果物の保存
- 入力：Z OK の生成物
- 出力：確定成果物
- 禁止：
  - 仕様更新
- 遷移：
  - 完了

---

## 2. M パート差分

- Z OK：
  - X を最新確定として更新
  - E パートのテーブルへ移行
- Z NG：
  - B へ戻る
- F は使用しない

---

## 3. E パート差分

- C / D / N / R は全自動
- Z OK：
  - S へ保存
- Z NG：
  - F へ遷移
- F 後：
  - 人間確定 → C

---

## 4. P パート差分

- 構造は M パートと同一
- 役割は最新 X の修正・追加専用
- Z OK：
  - X を更新
- Z NG：
  - B

---

以上。
