<!DOCTYPE html>
<html>
<head>
  <base target="_top">
  <?!= HtmlService.createHtmlOutputFromFile('common_ui').getContent(); ?>
</head>
<body onload="checkEnvironment();">
  <div class="app">
    <div class="header">
      <div class="titleWrap">
        <h1 class="title">UF07（価格入力）</h1>
        <p class="subtitle">BP の PRICE 未入力部材を補完します。</p>
      </div>
      <div class="pill warn">PRICE 推測禁止（GASが正式値を記録）</div>
    </div>

    <div class="card">
      <div class="cardHeader"><h2>入力</h2></div>
      <div class="cardBody">
        <div class="field">
          <label>OrderID</label>
          <input id="orderId" type="text" placeholder="orderPrefix-YYYYMMDD-00001-UP...">
        </div>
        <div class="field">
          <label>PART_ID（1件）</label>
          <input id="partId" type="text" placeholder="BP-YYYYMM-AAxx-PAyy">
        </div>
        <div class="field">
          <label>PRICE</label>
          <input id="price" type="number" inputmode="numeric" placeholder="例：12000">
        </div>

        <div class="btns">
          <button class="btn primary" id="btnSubmit" onclick="submitUF07();">送信（GAS）</button>
        </div>
      </div>
    </div>
  </div>

<script>
  function submitUF07(){
    var btn = qs('#btnSubmit');
    showBusy(btn, true);
    var payload = {
      orderId: qs('#orderId').value || '',
      partId: qs('#partId').value || '',
      price: qs('#price').value || ''
    };
    google.script.run
      .withSuccessHandler(function(res){ showBusy(btn,false); alert('送信しました'); })
      .withFailureHandler(function(err){ showBusy(btn,false); alert('エラー: ' + (err && err.message ? err.message : err)); })
      .onUF07Submit(payload);
  }
</script>
</body>
</html>
