<style>
  :root{
    --bg:#0b1220;
    --panel:#0f1a2f;
    --card:#101e38;
    --text:#e8eefc;
    --muted:#aab7d6;
    --line:rgba(232,238,252,.14);
    --accent:#5ba7ff;
    --danger:#ff5b6e;
    --ok:#29d08a;
    --warn:#ffcc66;
    --shadow: 0 12px 30px rgba(0,0,0,.35);
    --radius:14px;
  }
  html,body{ height:100%; }
  body{
    margin:0;
    font-family: system-ui, -apple-system, "Segoe UI", Roboto, "Noto Sans JP", "Hiragino Kaku Gothic ProN", "Meiryo", sans-serif;
    background: linear-gradient(160deg, var(--bg), #050a14 70%);
    color: var(--text);
  }
  .app{
    max-width: 1100px;
    margin: 0 auto;
    padding: 14px;
  }
  .header{
    display:flex;
    gap:12px;
    align-items:flex-start;
    justify-content:space-between;
    margin-bottom: 12px;
  }
  .titleWrap{ min-width:0; }
  .title{ font-size: 18px; font-weight: 800; margin:0; letter-spacing:.02em; }
  .subtitle{ margin:6px 0 0 0; color: var(--muted); font-size: 12px; }

  .grid{
    display:grid;
    gap: 12px;
    grid-template-columns: 1fr;
  }
  @media (min-width: 920px){
    .grid.two{ grid-template-columns: 1.2fr .8fr; align-items:start; }
  }

  .card{
    background: linear-gradient(180deg, rgba(255,255,255,.06), rgba(255,255,255,.03));
    border: 1px solid var(--line);
    border-radius: var(--radius);
    box-shadow: var(--shadow);
    overflow:hidden;
  }
  .cardHeader{
    padding: 12px 14px;
    border-bottom: 1px solid var(--line);
    display:flex;
    align-items:center;
    justify-content:space-between;
    gap:10px;
  }
  .cardHeader h2{ font-size: 14px; margin:0; font-weight: 800; }
  .cardBody{ padding: 12px 14px; }

  .field{ display:flex; flex-direction:column; gap:6px; margin-bottom: 12px; }
  .field label{ font-size: 12px; color: var(--muted); }
  input[type=text], input[type=tel], input[type=number], input[type=date], textarea, select{
    width: 100%;
    box-sizing: border-box;
    border-radius: 12px;
    border: 1px solid rgba(232,238,252,.18);
    background: rgba(16,30,56,.8);
    color: var(--text);
    padding: 12px 12px;
    outline: none;
    font-size: 16px; /* mobile zoom 防止 */
  }
  textarea{ min-height: 140px; resize: vertical; }

  .row{ display:grid; gap: 10px; grid-template-columns: 1fr; }
  @media (min-width: 700px){
    .row.two{ grid-template-columns: 1fr 1fr; }
    .row.three{ grid-template-columns: 1fr 1fr 1fr; }
  }

  .btns{ display:flex; flex-wrap:wrap; gap: 10px; }
  .btn{
    border: 0;
    border-radius: 12px;
    padding: 12px 14px;
    font-weight: 800;
    cursor: pointer;
    background: rgba(91,167,255,.2);
    color: var(--text);
    border: 1px solid rgba(91,167,255,.5);
  }
  .btn.primary{ background: rgba(91,167,255,.35); }
  .btn.danger{ background: rgba(255,91,110,.2); border-color: rgba(255,91,110,.6); }
  .btn.ghost{ background: transparent; border-color: rgba(232,238,252,.2); }
  .btn:disabled{ opacity: .55; cursor:not-allowed; }

  .pill{
    display:inline-flex;
    align-items:center;
    gap:8px;
    padding: 8px 10px;
    border-radius: 999px;
    font-size: 12px;
    border: 1px solid var(--line);
    background: rgba(16,30,56,.55);
  }
  .pill.danger{ border-color: rgba(255,91,110,.6); background: rgba(255,91,110,.12); }
  .pill.ok{ border-color: rgba(41,208,138,.6); background: rgba(41,208,138,.12); }
  .pill.warn{ border-color: rgba(255,204,102,.7); background: rgba(255,204,102,.12); }

  .help{
    font-size: 12px;
    color: var(--muted);
    line-height: 1.6;
  }
  .mono{ font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace; }

  .notice{
    padding: 10px 12px;
    border-radius: 12px;
    border: 1px dashed rgba(232,238,252,.22);
    background: rgba(16,30,56,.35);
    color: var(--muted);
    font-size: 12px;
    line-height: 1.6;
  }
</style>

<script>
  function checkEnvironment() {
    if (typeof google === "undefined" || !google.script || !google.script.run) {
      alert("このフォームは正しい方法で開かれていません。\nスプレッドシートのメニューから開いてください。");
    }
  }

  function qs(sel){ return document.querySelector(sel); }
  function qsa(sel){ return Array.prototype.slice.call(document.querySelectorAll(sel)); }

  function showBusy(btn, busy){
    if (!btn) return;
    btn.disabled = !!busy;
    btn.dataset._old = btn.dataset._old || btn.textContent;
    btn.textContent = busy ? "送信中..." : btn.dataset._old;
  }
</script>
